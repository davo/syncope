!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],e):"object"==typeof exports?exports.capHeight=e(require("lodash")):t.capHeight=e(t._)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e){function n(t,e,n){if(t===Object(t)){var r,i={};for(r in t)t.hasOwnProperty(r)&&(i[r]=Object.getOwnPropertyDescriptor(t,r),"boolean"==typeof e&&(i[r].writable=e),"boolean"==typeof n&&(i[r].configurable=n));return i}}function r(t){return n(t,!1,!1)}n.readonly=r,t.exports=n},function(t,e,n){function r(t){return u||(u=f.create(p,d)),u.compact(t)}function i(t){return a||(a=c.create(p,d)),a.expand(t)}function o(t){return l||(l=s.create(p,d)),l.parse(t)}var u,a,l,f=n(3),c=n(4),s=n(5),p=["font-style","font-weight"],d={"font-style":[["n","normal"],["i","italic"],["o","oblique"]],"font-weight":[["4","normal"],["7","bold"],["1","100"],["2","200"],["3","300"],["4","400"],["5","500"],["6","600"],["7","700"],["8","800"],["9","900"]]};e.compact=r,e.expand=i,e.parse=o},function(e,n){e.exports=t},function(t,e,n){function r(t,e){return Object.create(u,i({properties:t,values:e}))}var i=n(0),o=/\s+/g,u={compact:function(t){for(var e,n,r,i,u=["n","4"],a=(t||"").split(";"),l=0;l<a.length;l++)if(e=a[l].replace(o,"").split(":"),2===e.length&&(n=e[0],r=e[1],i=this.values[n]))for(var f=0;f<i.length;f++)i[f][1]===r&&(u[this.properties.indexOf(n)]=i[f][0]);return u.join("")}};e.create=r},function(t,e,n){function r(t,e){return Object.create(o,i({properties:t,values:e}))}var i=n(0),o={expand:function(t){if("string"!=typeof t||2!==t.length)return null;for(var e,n,r,i,o=[null,null],u=0;u<this.properties.length;u++)for(e=t[u],n=this.properties[u],r=this.values[n],j=0;j<r.length;j++)i=r[j],i[0]===e&&(o[u]=[this.properties[u],i[1]].join(":"));return o.indexOf(null)<0?o.join(";")+";":null}};e.create=r},function(t,e,n){function r(t,e){return Object.create(o,i({properties:t,values:e}))}var i=n(0),o={parse:function(t){if("string"!=typeof t||2!==t.length)return null;for(var e,n,r,i,o={},u=0;u<this.properties.length;u++)for(e=t[u],n=this.properties[u],r=this.values[n],j=0;j<r.length;j++)i=r[j],i[0]===e&&(o[this.properties[u]]=i[1]);return o[this.properties[0]]&&o[this.properties[1]]?o:null}};e.create=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n(2),o=r(i),u=n(1),a=r(u),l=.75,f=10,c=2,s=window.devicePixelRatio,p=void 0,d={"font-style":"normal","font-weight":400,"font-size":"100px","font-family":"serif"};o.default.mixin({fillRect:function(t,e,n,r,i){return o.default.tap(t,o.default.method("fillRect",e,n,r,i))},fillText:function(t,e,n,r){return o.default.tap(t,o.default.method("fillText",e,n,r))},scale:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return o.default.tap(t,o.default.method("scale",e,n))}});var h=function(t,e){return(0,o.default)(e).defaults(d).thru(o.default.partial(g,t)).value()};t.exports={calculate:h,fontActive:function(t,e){return function(n,r){return(0,o.default)(r).thru(a.default.parse).set("font-family",n).thru(o.default.partial(h,e)).thru(t).commit()}},inspect:function(t,e){return(0,o.default)(t).thru(window.getComputedStyle).pick(o.default.keys(d)).thru(o.default.partial(h,e)).value()},setContainer:function(t){p=t}};var g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"H",e=arguments[1],n=v(e),r=c*n;if(/\s/.test(t))throw new RangeError("Cannot calculate the height of whitespace.");var i={width:r*t.length,height:r},u=o.default.mapValues(i,S),a=m(i,u),l=y(a);l=w(l,e,i,t);var f=b(l,u),s=R(f);return(0,o.default)(l).set("fillStyle","rgba(255, 85, 51, .1)").fillRect(0,_(f.ascent),_(u.width),_(s)).commit(),x(a),o.default.assign(e,{"--cap-height":_(s)/n})},v=function(t){return o.default.chain(t).get("font-size",0).replace(/\D/g,"").toNumber().thru(function(t){if(isNaN(t))throw new RangeError("Cannot calculate the height of the text with invalid font-size.");if(0===t)throw new RangeError("Cannot calculate the height of the text with font-size: 0.");return t})},m=function(t,e){var n=(0,o.default)(t).set("margin",f).mapValues(function(t){return t+"px"}).value();return(0,o.default)(document.createElement("canvas")).assign(e).merge({style:n}).value()},x=function(t){o.default.isElement(p)&&p.appendChild(t)},y=function(t){return(0,o.default)(t.getContext("2d")).scale(s).value()},w=function(t,e,n,r){var i=n.width,u=n.height;return(0,o.default)(t).set("fillStyle","white").fillRect(0,0,i,u).assign({font:j(e),fillStyle:"black",textAlign:"center",textBaseline:"middle"}).fillText(r,i/2,u/2).value()},j=function(t){return(0,o.default)(t).at("font-style","font-weight","font-size","font-family").join(" ")},b=function(t,e){var n=e.width,r=e.height,i=O(t,n,r);return{ascent:C(i,n),descent:z(i,n)}},O=function(t,e,n){return t.getImageData(0,0,e,n).data},R=function(t){var e=t.descent,n=t.ascent;return e-n+1},C=function(t,e){var n=o.default.findIndex(t,P);return E(n,e)},z=function(t,e){var n=o.default.findLastIndex(t,P);return E(n,e)},E=function(t,e){return o.default.floor(t/4/e)},P=function(t){return t<255*l},_=function(t){return t/s},S=function(t){return t*s}}])});
//# sourceMappingURL=cap-height.js.map